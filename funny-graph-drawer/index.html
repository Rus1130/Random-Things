<style>
    #graph {
        border: 1px solid black;
        /*
        make the width and height always the same
        */
        width: 500px;
        height: 500px;
        position: absolute;
        left: 5px;
        top: 25%;

        display: grid;
    }
    #input {
        resize: none;
        width: 500px;
        height: 170px;
        position: absolute;
        left: 5px;
    }
    #input:focus {
        outline: none;
    }
    #blocker {
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1000;
        font-size: 100px;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    #draw-button {
        height: 50px;
        width: 100px;
        border: 1px solid black;
        position: absolute;
        left: 520px;
    }
</style>
<head>
    <script src="https://unpkg.com/mathjs@11.4.0/lib/browser/math.js"></script>
</head>
<body>
    <textarea id="input">x = y^2</textarea>
    <div id="graph"></div>
    <div id="draw-button" onclick="draw(input.value)"></div>
</body>
<script>
    // make this a module
    const graph = document.getElementById("graph");
    const input = document.getElementById("input");

    const colors = ['#000000', '#0000FF', '#00FF00', '#FF0000', '#00FFFF', '#FF00FF', '#FFFF00', "#C74440", '#2D70B3', "#388C46", "#FA7E19", "#6042A6"];


    const xCellMax = 50;
    const yCellMax = 50;
    const precision = 4;
    const iterator = 1 / (precision / 2);

    const parser = math.parser()

    let yMin = -yCellMax;
    let yMax = yCellMax;
    let xMin = -xCellMax;
    let xMax = xCellMax;

    // get the graph style
    graph.style.gridTemplateColumns = `repeat(${xCellMax * precision + 1}, 1fr)`;
    graph.style.gridTemplateRows = `repeat(${yCellMax * precision + 1}, 1fr)`;


    function clean(string){
        return Array(Array(string.trim()).reverse().join().trim()).reverse().join();
    }

    function draw(input){
        let xIteration = 0;
        let yIteration = 0;
        let startTime = Date.now();
        for(let y = yMax; y >= yMin; y -= iterator){
            for(let x = xMin; x <= xMax; x += iterator){
                let div = document.createElement('div');
                div.id = `${x},${y}`;
                
                let left = clean(input.split('=')[0]);
                let right = math.evaluate(clean(input.split('=')[1]), {x: x, y: y});

                if(left == 'x'){
                    if(x == right){
                        div.style.backgroundColor = colors[0];
                        div.setAttribute('plot', 'true');
                    }
                } else if(left == 'y'){
                    if(y == right){
                        div.style.backgroundColor = colors[0];
                        div.setAttribute('plot', 'true');
                    }
                }

                if((y == 0 && x % 2 == 0) || (x == 0 && y % 2 == 0)){
                    div.style.backgroundColor = 'black';
                }

                // get the total percentage of completion
                xIteration++;
                // get the percentage of completion for the whole graph
                let percentage = math.round((xIteration + (yIteration * (xCellMax * precision + 1))) / ((xCellMax * precision + 1) * (yCellMax * precision + 1)) * 100, 1) / 2;

                console.log(`completion: ${percentage}%, x iteration: ${xIteration}, y iteration: ${yIteration}`);
                graph.appendChild(div);
            }
            yIteration++;
        }

        console.warn('done!')
        console.log(`Total X iterations: ${xIteration}`);
        console.log(`Total Y iterations: ${yIteration - 1}`);
        console.log(`Elapsed time: ${parser.evaluate(`${Date.now() - startTime} ms to s`)}`);
    }


    // https://www.youtube.com/watch?v=JnCkF62gkOY
    // total iterations for 4 precision: 8080200

</script>