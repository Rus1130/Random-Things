<style>
    #container {
        width: 600px;
        height: 600px;
        border: 1px solid black;
    }
</style>
<head>
    <script src="./two.js"></script>
</head>
<body>
    <div id="container"></div>
    <button id="toggleLineOpacity">Toggle Line</button>
    <button id="toggleGuideCircle">Toggle Guide Circle</button>
    <button id="togglePause">Toggle Pause</button>
    <label for="speedControl">Speed</label>
    <input type="range" min="0.1" max="50" value="5" id="speedControl">
</body>
<script>
    const container = document.getElementById('container')
    let two = new Two({
        width: 600,
        height: 600,
        autostart: true
    }).appendTo(container);

    const offset = offset => 300 + offset;
    let pointsAmount = 3

    const outline = two.makeCircle(offset(0), offset(0), 200);
    
    outline.stroke = 'black';
    outline.linewidth = 2;

    let lines = []
    let guidelines = [];
    let points = []

    let rotation = Math.PI;
    let speed = 0.05

    let paused = false;

    function getGuidePoints(){
        return {
            x: offset(-100 * Math.cos(rotation)),
            y: offset(-100 * Math.sin(-rotation))
        }
    }

    document.getElementById('toggleLineOpacity').addEventListener('click', () => {
        lines.forEach(line => {
            line.opacity = line.opacity === 0.8 ? 0 : 0.8;
        });
    });

    document.getElementById('speedControl').addEventListener('input', (e) => {
        speed = e.target.value / 100;
    });

    document.getElementById('toggleGuideCircle').addEventListener('click', () => {
        guideCircle.opacity = guideCircle.opacity === 0 ? 1 : 0;
    });

    document.getElementById('togglePause').addEventListener('click', () => {
        paused = !paused;
    });

    function drawLines(p){
        lines.forEach(line => {
            two.remove(line);
        });
        for(i = 0; i < pointsAmount; i++){
            let line = two.makeLine(0, -500, 0, 500);
            line.rotation = (i / pointsAmount) * Math.PI;
            line.linewidth = 1;
            line.stroke = 'black';
            line.id = `line${i}`;
            line.opacity = 0.8;

            line.translation.set(offset(0), offset(0));
            lines.push(line);

            let x = Math.sin((i / pointsAmount) * Math.PI) * 200;
            let y = Math.cos((i / pointsAmount) * Math.PI) * 200;

            let point = two.makeCircle(offset(x), offset(y), 10);
            point.fill = 'black';
            points.push(point);

            let guideline = two.makeLine(0, -200, 0, 200);
            guideline.linewidth = 2;
            guideline.stroke = 'red';
            guideline.id = `guideline${i}`;
            guideline.rotation = (i / pointsAmount) * Math.PI;
            guideline.translation.set(offset(0), offset(0));

            guidelines.push(guideline);
        }
    }

    drawLines(pointsAmount);

    const guideCircle = two.makeCircle(getGuidePoints().x, getGuidePoints().y, outline.radius / 2);    
    guideCircle.linewidth = 2;
    guideCircle.noFill();


    two.bind('update', function(frameCount) {
        if (paused) return;
        rotation += speed;
        guideCircle.translation.set(getGuidePoints().x, getGuidePoints().y);

        for(i = 0; i < pointsAmount; i++){
            
            // move the points along the red lines


            points[i].translation.set(lines[i].translation.x, lines[i].translation.y);
        }
    }).play();


</script>