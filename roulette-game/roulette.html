<style>
    div {
        font-family: Arial, Helvetica, sans-serif;
    }
    textarea {
        font-family: Arial, Helvetica, sans-serif;
        resize: none;
    }
    textarea:focus {
        outline: none;
    }


    #alert {
        width: 15%;
        min-width: 300px;
        height: 20%;
        min-height: 200px;
        border: 1px solid black;
        position: absolute;
        z-index: 1;
        background-color: white;
    }
    #container {
        display: grid;
        row-gap: 1px;
    }
    #wrapper {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
    }
    #alert-text {
        width: 100%;
        height: 100%;

        /*center the text*/
        text-align: center;
        /*center the text vertically*/
        display: flex;
        justify-content: center;
        align-items: center;
        
        font-size: calc(100% + 0.3vw);
    }



    #submitBetButton {
        width: calc(100% - 1);
        height: 20px;
        border: 1px solid black;
        background-color: rgb(159, 187, 247);
        transition: background-color 0.5s;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    #submitBetButton:hover {
        cursor: pointer;
        background-color: rgb(101, 150, 255);
    }





    #close {
        background-color: firebrick;   
        user-select: none;
        width: calc(100% + 2px);
        height: calc(10% + 2px);
        position: absolute;
        bottom: calc(-10% - 3px);
        display: flex;
        justify-content: center;
        align-items: center;
        /*scale the font size with the size of #close */
        font-size: calc(100% + 0.3vw);

        transition: background-color 0.5s;
    }
    #close:hover {
        background-color: rgb(210, 26, 26);
        cursor: pointer;
    }

    .hidden {
        display: none;
    }

    #bet-on {
        font-size: 20px;
    }

    #bet-amount {
        font-size: 20px;
    }

    #stats {
        position: absolute;
        top: 0;
    }

    #bankingMenu {
        width: 30%;
        min-width: 300px;
        height: 50%;
        min-height: 300px;
        position: absolute;
        z-index: 1;
        background-color: white;
        border: 1px black solid;

    }

</style>
<head>
    <script src="math.js"></script>
</head>
<body>
    <div id="wrapper">
        <div id="alert" class="hidden">
            <div id="alert-text"></div>
            <div id="wrapper">
                <div id="close" onclick="closeAlertBox()">X</div>
            </div>
        </div>
        <div id="container">
            <div id="moneyCounter" style="text-align: center">Bet Money: $100</div>
            <textarea placeholder="what you bet on (red, black, or a number)" id="bet-on">red</textarea>
            <textarea placeholder="your bet" id="bet-amount">1</textarea>
            <div id="submitBetButton" onclick="submitBet()">Bet!</div>
        </div>
        <div id="bankingMenu" class="hidden">nothing here for now</div>
            
        </div>
    </div>
    <div id="stats">
        Wins: 0<br>
        Losses: 0<br>
        Money won: $0<br>
        Money lost: $0<br>
        Times you went into debt: 0<br>
        Numbers landed: 0<br>
        Colors landed: 0<br><br><br>
        e to open banking menu
    </div>
    



</body>
<head>

</head>
<script>
    const alertBox = document.getElementById('alert')
    const alertText = document.getElementById('alert-text')
    const closeButton = document.getElementById('close')

    const betAmountElem = document.getElementById('bet-amount')
    const betOnElem = document.getElementById('bet-on')

    const moneyCounter = document.getElementById('moneyCounter')
    const bankingMenu = document.getElementById('bankingMenu')

    const statsElem = document.getElementById('stats')

    function closeAlertBox(){
        alertBox.classList.add('hidden')
    }

    const stats = {
        Wins: 0,
        Losses: 0,
        Money_won: 0,
        Money_lost: 0,
        Times_you_went_into_debt: 0,
        Numbers_landed: 0,
        Colors_landed: 0
    }

    const numbers = {
        0: 'green',
        32: 'red',
        15: 'black',
        19: 'red',
        4: 'black',
        21: 'red',
        2: 'black',
        25: 'red',
        17: 'black',
        34: 'red',
        6: 'black',
        27: 'red',
        13: 'black',
        36: 'red',
        11: 'black',
        30: 'red',
        8: 'black',
        23: 'red',
        10: 'black',
        5: 'red',
        24: 'black',
        16: 'red',
        33: 'black',
        1: 'red',
        20: 'black',
        14: 'red',
        31: 'black',
        9: 'red',
        22: 'black',
        18: 'red',
        29: 'black',
        7: 'red',
        28: 'black',
        12: 'red',
        35: 'black',
        3: 'red',
        26: 'black'
    }

    let money = 100;

    function submitBet(){
        betOnElem.value = betOnElem.value.trim()
        betAmountElem.value = betAmountElem.value.trim()

        
        let betOn = betOnElem.value
        let betAmount = betAmountElem.value

        let redNumbers = Object.keys(numbers).filter(key => numbers[key] == 'red')
        let blackNumbers = Object.keys(numbers).filter(key => numbers[key] == 'black')

        if (betAmount == '' || isNaN(betAmount)){
            alertText.innerHTML = 'You must bet a number.'
            betAmountElem.value = ''
            alertBox.classList.remove('hidden')
            return
        }

        betAmount = parseInt(betAmount)

        if(betAmount > money){
            alertText.innerHTML = "You can't bet what you don't have."
            betAmountElem.value = ''
            alertBox.classList.remove('hidden')
            return
        }

        if (betOn != 'red' && betOn != 'black' && betOn != 'green'){
            if(!redNumbers.includes(betOn) && !blackNumbers.includes(betOn)){
                alertText.innerHTML = 'You must bet on red, black, or a number.'
                betOnElem.value = ''
                alertBox.classList.remove('hidden')
                return
            }
        }

        // get a random number, but weight it against landing on the color the user bet on

        let unweightedSpunNumber = Math.floor(Math.random() * 37)


        function weightedRand(spec) {
            var i, j, table=[];
            for (i in spec) {
                for (j=0; j<spec[i]*10; j++) {
                    table.push(i);
                }
            }
            return function() {
                return table[Math.floor(Math.random() * table.length)];
            }
        }

        let weights = {}
        for(i = 1; i <= 36; i++){
            weights[i] = math.round(1/36, 6)
        }


        // add each key of the weights object togehter
        let totalWeight = 0
        for(let key in weights){
            totalWeight += weights[key]
        }

        for(let key in weights){
            if(key == unweightedSpunNumber){
                weights[key] -= 0.017778
            } else {
                weights[key] += 0.017778
            }
        }



        let spinNumber = weightedRand(weights)
        let spunNumber = spinNumber()

        console.log(weights)
        console.log(unweightedSpunNumber)
        console.log(spunNumber)


        

        

        let spunColor = numbers[spunNumber]
        let colorWeights = {
            red: 0.4999,
            black: 0.4999,
            green: 0.0004
        }

        alertBox.classList.remove('hidden')


        if(betOn == spunColor){
            if(spunColor == 'green'){
                stats.Money_won += betAmount * 35
                stats.Wins += 1
                stats.Colors_landed += 1

                money += betAmount * 35
                alertText.innerHTML = `You landed on ${spunColor}}! You got $${betAmount * 35}!` 
            } else {
                stats.Money_won += betAmount
                stats.Wins += 1
                stats.Colors_landed += 1

                money += betAmount
                alertText.innerHTML = `You landed on ${spunColor}. You got $${betAmount}.`
            }
        } else if(betOn == spunNumber){
            stats.Money_won += betAmount * 35
            stats.Wins += 1
            stats.Numbers_landed += 1

            money += betAmount * 35
            alertText.innerHTML = `You landed on a ${spunNumber}}! You got $${betAmount * 35}!`
        } else {
            stats.Money_lost += betAmount
            stats.Losses += 1

            money -= betAmount

            if(money < 0){
                stats.Times_you_went_into_debt += 1
            }
            alertText.innerHTML = `You didn't spin a ${spunColor}. You lost $${betAmount}.`
        }



        let statBuffer = ''

        for(let stat in stats){
            statBuffer += `${stat}: ${stat == "Money_won" || stat == "Money_lost" ? "$" : ""}${stats[stat]}<br>`
        }

        statBuffer += `<br><br>e to open banking menu`

        statsElem.innerHTML = statBuffer.replaceAll("_", " ")
        moneyCounter.innerHTML = `$${money}`
    }


    document.addEventListener('keydown', function(event){
        if(event.key == 'e'){
            if(bankingMenu.classList.contains('hidden')){
                bankingMenu.classList.remove('hidden')
            } else {
                bankingMenu.classList.add('hidden')
            }
        }
    })


</script>

<!--credits to mattkoco-->