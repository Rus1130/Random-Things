<style>
    input {
        border: 0.5px solid black;
    }
    input:focus {
        outline: none;
        border: 0.5px solid black;
    }
    select {
        border: 0.5px solid black;
    }
    select:focus {
        outline: none;
        border: 0.5px solid black;
    }

    html {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 14pt;
    }
    .focus {
        display: initial;
    }
    .unfocus {
        display: none;
    }
</style>

<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>

<body>
    <div id="output" style="height: 30px; font-size: 20pt;">&nbsp;</div>
    <div id="rus" class="focus">
        <input type="text" id="convert" onchange="convertRus(convertType.value, convertText.value)">
        <select id="typeSelect" onchange="convertRus(convertType.value, convertText.value)" title="Type" style="cursor: pointer;">
            <option value="IPA">IPA</option>
            <option value="phagspa">Phagspa</option>
        </select>
        <span style="font-size: 12pt;">
            Dialect:
            <select id="dialectSelect">
                <option value="rus">Rus</option>
            </select>
        </span>
        <span id="flourishFull" class="unfocus">
            <input type="checkbox" id="flourish" name="flourish" checked>
            <label for="flourish">Flourish</label>
        </span>
    </div>

    <div id="aspyn" class="unfocus">
        <input type="text" id="convert" onchange="convertRus(convertType.value, convertText.value)">
        <select id="typeSelect" onchange="convertRus(convertType.value, convertText.value)" title="Type" style="cursor: pointer;">
            <option value="IPA">IPA</option>
            <option value="phagspa">Phagspa</option>
        </select>
        <span style="font-size: 12pt;">
            Dialect:
            <select id="dialectSelect">
                <option value="rus">Rus</option>
            </select>
        </span>
    </div>
</body>


<script>

    var rusDialect = document.getElementById("rus")
    var aspynDialect = document.getElementById("aspyn")


    var convertType = document.getElementById("typeSelect");
    var output = document.getElementById("output");
    var convertText = document.getElementById("convert");
    var adder;
    var flourishCheckbox = document.getElementById("flourish")
    var leftFlourish;
    var rightFlourish;
    var typeType = "IPA";

    let conversionHandlerArray = new Array();

    function convertRus(type, text){
        switch(type){
            case "IPA":
                typeType = "IPA";
                conversionHandlerArray = [];
                [...text].forEach(function(c){
                    adder = inventory[c]["IPA"]
                    conversionHandlerArray.push(adder);
                })
                break;
            case "phagspa":
                typeType = "phagspa";
                conversionHandlerArray = [];
                [...text].forEach(function(c){
                    adder = inventory[c]["phagspa"]
                    conversionHandlerArray.push(adder)
                })
                break;
            default:
                return console.error("syntax error");
        }
    }

    function checkFlourish(){
        if (typeType == "phagspa" && flourishCheckbox.checked == true){
            document.getElementById("flourishFull").setAttribute("class","focus")
            leftFlourish = "ꡲ";
            rightFlourish = "ꡳ";
            output.innerHTML = leftFlourish + conversionHandlerArray.join("") + rightFlourish
        } else {
            if(typeType == "IPA"){
                document.getElementById("flourishFull").setAttribute("class","unfocus")
                leftFlourish = "[";
                rightFlourish = "]";
                output.innerHTML = leftFlourish + conversionHandlerArray.join("") + rightFlourish
            } else {
                if(flourishCheckbox.checked == false){
                    document.getElementById("flourishFull").setAttribute("class","focus")
                    leftFlourish = "";
                    rightFlourish = "";
                    output.innerHTML = leftFlourish + conversionHandlerArray.join("") + rightFlourish
                }
            }
        }
    }

    setInterval(function(){
        checkFlourish()
    },1)

    function dialectRusShow(){
        rusDialect.setAttribute("class","focus")
        aspynDialect.setAttribute("class","unfocus")
    }

    function dialectAspynShow(){
        rusDialect.setAttribute("class","unfocus")
        aspynDialect.setAttribute("class","focus")
    }


    const inventory = {
        "p":{
            IPA:"p",
            phagspa:"ꡁ"
        },
        "b":{
            IPA:"b",
            phagspa:"ꡂ"
        },
        "t":{
            IPA:"t",
            phagspa:"ꡎ"
        },
        "d":{
            IPA:"d",
            phagspa:"ꡍ"
        },
        "k":{
            IPA:"k",
            phagspa:"ꡌ"
        },
        "g":{
            IPA:"g",
            phagspa:"ꡖ"
        },
        "f":{
            IPA:"f",
            phagspa:"ꡰ"
        },
        "s":{
            IPA:"s",
            phagspa:"ꡞ"
        },
        "c":{
            IPA:"ɕ",
            phagspa:"ꡟ"
        },
        "h":{
            IPA:"x",
            phagspa:"ꡜ"
        },
        "j":{
            IPA:"j",
            phagspa:"ꡬ"
        },
        "r":{
            IPA:"ɾ",
            phagspa:"ꡮ"
        },
        "x":{
            IPA:"ɬ",
            phagspa:"ꡤ"
        },
        "l":{
            IPA:"ʎ",
            phagspa:"ꡣ"
        },
        "z":{
            IPA:"t͡s",
            phagspa:"ꡔ"
        },
        "m":{
            IPA:"m",
            phagspa:"ꡋ"
        },
        "n":{
            IPA:"n",
            phagspa:"ꡏ"
        },
        "i":{
            IPA:"i",
            phagspa:"ꡱ"
        },
        "í":{
            IPA:"ɨ",
            phagspa:"ꡙ"
        },
        "ú":{
            IPA:"ɯ",
            phagspa:"ꡯ"
        },
        "u":{
            IPA:"u",
            phagspa:"ꡊ"
        },
        "ö":{
            IPA:"ø",
            phagspa:"ꡧ"
        },
        "o":{
            IPA:"o",
            phagspa:"ꡑ"
        },
        "e":{
            IPA:"ɛ",
            phagspa:"ꡭ"
        },
        "ó":{
            IPA:"ɔ",
            phagspa:"ꡨ"
        },
        "a":{
            IPA:"a",
            phagspa:"ꡅ"
        },
        " ":{
            IPA:" ",
            phagspa:" "
        },
        ".":{
            IPA:".",
            phagspa:""
        }
    }

</script>