<style>
    html {
        font-family: monospace;
        user-select: none;
        font-size: 18px;
        margin: 0px;
    }
    input:focus {
        outline: none;
    }
    .visible {
        display: initial;
    }
    .invisible {
        display: none;
    }
    #btn {
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: monospace;
        border: 1px black solid;
        border-radius: 2px;
        font-size: 15px;
        background-color: beige;
    }

</style>
<head>
    <script src="https://unpkg.com/hotkeys-js/dist/hotkeys.min.js"></script>
</head>
<body>
    <div id="setup-container">
        Gameboard Rows: <input type="number" id="board-rows" min="8" max="32" value="16"><br>
        Gameboard Columns: <input type="number" id="board-columns" min="16" max="64" value="32"><br>
        <button id="btn" onclick="setup()">New Game</button>
    </div>
    <div id="ui-container" class="invisible">
        <button id="btn" onclick="reset()">Back to Menu</button>
    </div>
    <br>
    <div id="top-border"></div>
    <div id="game-space"></div>
    <div id="bottom-border"></div>
</body>

<script>

const bkgd = "&nbsp;" // &nbsp; test: ▒
const setupContainer = document.getElementById("setup-container")
let rowsInput = document.getElementById("board-rows")
let colsInput = document.getElementById("board-columns")
let gamespace = document.getElementById("game-space")
let gameboard = [];
let straightFrame = [];
const exposedPartitionsAmount = 2;
let partitions = []
let rowConcatenator = new String;
let exposedBitramPartitionTemplate = {
    tl: "", tm: "", tr: "",
    ml: "", sprite: "", mr: "",
    bl: "", bm: "", br: ""
}

let state = "setup";

let player = {
    sprite: "O",
    x: "",
    y: ""
}

function random(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1) + min);
}

function reset(){
    location.reload()
}

function setup(){
    if(state != "setup"){} else {
        if(rowsInput.value == "" || colsInput.value == ""){
            alert("Please fill out all fields.")
        } else {
            document.getElementById("ui-container").removeAttribute("class","invisible")
            document.getElementById("setup-container").setAttribute("class","invisible")
            for (i = 0; i < rowsInput.value; i++) {
                gameboard.push([]);
                for (j = 0; j < colsInput.value; j++) {
                    gameboard[i].push(bkgd);
                }
            }
            for(k = 0; k < gameboard[0].length; k++){
                straightFrame.push("═")
                
            }
            for(l = 0; l < exposedPartitionsAmount; l++){
                let identifier = "partition" + l
                let partitionY = random(3, gameboard.length - 3)
                let partitionX = random(3, gameboard[partitionY].length - 3)
                partitions.push({
                    [identifier]: {
                        quality: "A",
                        x: partitionX,
                        y: partitionY
                    }
                })
            }
            document.getElementById("top-border").innerHTML = "╔" + straightFrame.join("") + "╗"
            document.getElementById("bottom-border").innerHTML = "╚" + straightFrame.join("") + "╝"
            player.y = random(0, gameboard.length)
            player.x = random(0, gameboard[player.y].length - 1)
            gamespace.innerHTML = JSON.stringify(gameboard).replaceAll("],[","║<br>║").replace("[[","║").replace("]]","║").replaceAll('"',"").replaceAll(",","")
            state = "play"
        }
    }
}


hotkeys('w,a,s,d', function (event, handler){
    switch (handler.key){
        case 'w':
            if(state != "play"){} else {
                if(player.y > 0){
                    gameboard[player.y][player.x] = bkgd
                    player.y -= 1;
                }
            }
        break;
        case 'a':
            if(state != "play"){} else {
                if(player.x > 0){
                    gameboard[player.y][player.x] = bkgd
                    player.x -= 1;
                }
            }
        break;
        case 's':
            if(state != "play"){} else {
                if(player.y < gameboard.length - 1){
                    gameboard[player.y][player.x] = bkgd
                    player.y += 1;
                }
            }
        break;
        case 'd':
            if(state != "play"){} else {
                if(player.x < gameboard[0].length - 1){
                    gameboard[player.y][player.x] = bkgd
                    player.x += 1;
                }
            }
        break;
    }
});


function boardUpdate(){
    if(state != "play"){} else {

        gameboard[player.y][player.x] = player.sprite
        gamespace.innerHTML = JSON.stringify(gameboard).replaceAll("],[","║<br>║").replace("[[","║").replace("]]","║").replaceAll('"',"").replaceAll(",","")
        
    }
}

setInterval(() => boardUpdate(), 16.67)

</script>